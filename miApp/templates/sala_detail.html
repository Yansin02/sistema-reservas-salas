{% extends 'base.html' %}

{% block title %}{{ sala.nombre }} - Detalles{% endblock %}

{% block content %}

<a href="{% url 'miApp:home' %}" class="btn" style="margin-bottom: 2rem; display: inline-flex; align-items: center; gap: 0.5rem;">
    â† Volver a Salas
</a>

<div style="background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
    <div style="display: flex; justify-content: between; align-items: start; margin-bottom: 2rem;">
        <div>
            <h1 style="color: #333; margin-bottom: 0.5rem;">{{ sala.nombre }}</h1>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <span style="background: #17a2b8; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">
                    Capacidad: {{ sala.capacidad }} personas
                </span>
                <span style="background: #6c757d; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">
                    Estado: {{ sala.estado }}
                </span>
                
                <!-- MOSTRAR DISPONIBILIDAD -->
                {% if sala.disponible and not reserva_activa %}
                <span style="background: #28a745; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">
                    âœ… Disponible
                </span>
                {% else %}
                <span style="background: #dc3545; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">
                    â° Reservada
                </span>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- SECCIÃ“N DE RESERVA ACTIVA -->
    {% if reserva_activa %}
    <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
        <h3 style="color: #856404; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
            â° Sala Actualmente Reservada
        </h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div>
                <p style="margin: 0.5rem 0;"><strong>ğŸ‘¤ Persona:</strong> {{ reserva_activa.nombre_completo }}</p>
                <p style="margin: 0.5rem 0;"><strong>ğŸ†” RUT:</strong> {{ reserva_activa.rut_persona }}</p>
            </div>
            <div>
                <p style="margin: 0.5rem 0;"><strong>ğŸ• Inicio:</strong> {{ reserva_activa.fecha_hora_inicio|date:"d/m/Y H:i" }} (hora Chile)</p>
                <p style="margin: 0.5rem 0;"><strong>ğŸ•’ TÃ©rmino:</strong> {{ reserva_activa.fecha_hora_termino|date:"d/m/Y H:i" }} (hora Chile)</p>
            </div>
        </div>
        <p style="margin-top: 1rem; color: #856404; font-size: 0.9rem;">
            <strong>Nota:</strong> La sala estarÃ¡ disponible despuÃ©s de la hora de tÃ©rmino.
        </p>
    </div>
    {% endif %}

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px;">
            <h3 style="color: #333; margin-bottom: 1rem;">ğŸ“‹ InformaciÃ³n General</h3>
            <p><strong>Nombre:</strong> {{ sala.nombre }}</p>
            <p><strong>Capacidad:</strong> {{ sala.capacidad }} personas</p>
            <p><strong>Estado:</strong> {{ sala.estado }}</p>
            <p><strong>Disponible:</strong> {{ sala.disponible|yesno:"SÃ­,No" }}</p>
            <p><strong>Habilitada:</strong> {{ sala.habilitada|yesno:"SÃ­,No" }}</p>
        </div>
        
        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px;">
            <h3 style="color: #333; margin-bottom: 1rem;">ğŸ’¡ CaracterÃ­sticas</h3>
            <p>âœ… Espacio climatizado</p>
            <p>âœ… Proyector disponible</p>
            <p>âœ… Wi-Fi de alta velocidad</p>
            <p>âœ… Servicio de cafÃ©</p>
            <p>âœ… Soporte tÃ©cnico</p>
        </div>
    </div>

    <!-- BOTÃ“N DE RESERVA SOLO SI ESTÃ DISPONIBLE -->
    {% if sala.disponible and not reserva_activa %}
    <div style="text-align: center; padding: 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
        <h2 style="margin-bottom: 1rem;">Â¿Te interesa esta sala?</h2>
        <p style="margin-bottom: 2rem; opacity: 0.9;">Reserva ahora y asegura tu espacio por 2 horas.</p>
        <a href="{% url 'miApp:reservar_sala' sala.id %}" class="btn" style="background: white; color: #667eea; font-weight: bold; padding: 1rem 2rem;">
            Reservar Esta Sala
        </a>
    </div>
    {% else %}
    <div style="text-align: center; padding: 2rem; background: #f8f9fa; border-radius: 10px;">
        <h3 style="color: #666; margin-bottom: 1rem;">â³ Sala No Disponible</h3>
        <p style="color: #888;">Esta sala estÃ¡ actualmente reservada. Intenta mÃ¡s tarde.</p>
    </div>
    {% endif %}
</div>
{% endblock %}